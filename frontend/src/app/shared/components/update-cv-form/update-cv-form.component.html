<form
  nz-form
  [formGroup]="cvForm"
  (ngSubmit)="onSubmit()"
  class="w-4/5 space-y-2 mb-4"
>
  <div>
    <nz-form-item>
      <nz-form-label nzFor="name" [nzRequired]="true">CV name</nz-form-label>
      <nz-form-control [nzErrorTip]="'cvForm.nameError' | translate">
        <input
          type="text"
          nz-input
          formControlName="name"
          id="name"
          placeholder="Name"
        />
      </nz-form-control>
    </nz-form-item>
  </div>
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
    <div class="flex flex-col">
      <nz-form-item>
        <nz-form-label nzFor="firstName" [nzRequired]="true"
          >First Name</nz-form-label
        >
        <nz-form-control
          [nzErrorTip]="'employeeForm.firstNameError' | translate"
        >
          <input
            type="text"
            nz-input
            formControlName="firstName"
            id="firstName"
            placeholder="First Name"
          />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div class="flex flex-col">
      <nz-form-item>
        <nz-form-label nzFor="lastName" [nzRequired]="true"
          >Last Name</nz-form-label
        >
        <nz-form-control
          [nzErrorTip]="'employeeForm.lastNameError' | translate"
        >
          <input
            type="text"
            nz-input
            formControlName="lastName"
            id="lastName"
            placeholder="Last Name"
          />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div class="flex flex-col">
      <nz-form-item>
        <nz-form-label nzFor="email" [nzRequired]="true">Email</nz-form-label>
        <nz-form-control [nzErrorTip]="'employeeForm.emailError' | translate">
          <input
            type="email"
            nz-input
            formControlName="email"
            id="email"
            placeholder="Email"
          />
        </nz-form-control>
      </nz-form-item>
    </div>
  </div>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
    <div class="flex flex-col">
      <nz-form-item>
        <nz-form-label nzFor="specialization" [nzRequired]="true"
          >Specialization</nz-form-label
        >
        <nz-form-control
          [nzErrorTip]="'employeeForm.specializationError' | translate"
        >
          <input
            type="text"
            nz-input
            formControlName="specialization"
            id="specialization"
            placeholder="Specialization"
          />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div class="flex flex-col">
      <nz-form-item>
        <nz-form-label nzFor="department" [nzRequired]="true"
          >Department</nz-form-label
        >
        <nz-form-control
          [nzErrorTip]="'employeeForm.departmentError' | translate"
        >
          <input
            type="text"
            nz-input
            formControlName="department"
            id="department"
            placeholder="Department"
          />
        </nz-form-control>
      </nz-form-item>
    </div>
  </div>
  <div formArrayName="skills" class="w-full">
    <div *ngFor="let skill of skills.controls; let i = index" class="mb-4">
      <div class="flex items-center" [formArrayName]="i">
        <div class="w-3/5">
          <nz-select
            formControlName="skillId"
            [nzPlaceHolder]="'Select a skill'"
            class="w-full"
          >
            <nz-option
              *ngFor="let s of skillOptions$ | async"
              [nzValue]="s.id"
              [nzLabel]="s.name"
            ></nz-option>
          </nz-select>
        </div>

        <div class="w-1/5 pl-4">
          <nz-slider
            formControlName="level"
            [nzMin]="1"
            [nzMax]="5"
            [nzStep]="1"
            class="w-full"
          ></nz-slider>
        </div>

        <div class="w-1/5 pl-4">
          <button
            nz-button
            nzType="default"
            nzDanger
            type="button"
            (click)="removeSkill(i)"
          >
            Remove
          </button>
        </div>
      </div>
    </div>
  </div>
  <div>
    <button nz-button nzType="primary" type="button" (click)="addSkill()">
      Add Skill
    </button>
  </div>

  <div formArrayName="languages" class="w-full">
    <div
      *ngFor="let language of languages.controls; let i = index"
      class="mb-4"
    >
      <div class="flex items-center" [formArrayName]="i">
        <div class="w-3/5">
          <nz-select
            formControlName="languageId"
            [nzPlaceHolder]="'Select a language'"
            class="w-full"
          >
            <nz-option
              *ngFor="let l of languageOptions$ | async"
              [nzValue]="l.id"
              [nzLabel]="l.name"
            ></nz-option>
          </nz-select>
        </div>

        <div class="w-1/5 pl-4">
          <nz-select
            formControlName="level"
            [nzPlaceHolder]="'Select a level'"
            class="w-full"
          >
            <nz-option nzValue="A1" nzLabel="A1"></nz-option>
            <nz-option nzValue="A2" nzLabel="A2"></nz-option>
            <nz-option nzValue="B1" nzLabel="B1"></nz-option>
            <nz-option nzValue="B2" nzLabel="B2"></nz-option>
            <nz-option nzValue="C1" nzLabel="C1"></nz-option>
            <nz-option nzValue="C2" nzLabel="C2"></nz-option>
            <nz-option nzValue="Native" nzLabel="Native"></nz-option>
          </nz-select>
        </div>

        <div class="w-1/5 pl-4">
          <button
            nz-button
            nzType="default"
            nzDanger
            type="button"
            (click)="removeLanguage(i)"
          >
            Remove
          </button>
        </div>
      </div>
    </div>
  </div>
  <div>
    <button nz-button nzType="primary" type="button" (click)="addLanguage()">
      Add language
    </button>
  </div>

  <div class="w-full">
    <div class="flex flex-row space-x-2">
      <nz-select
        formControlName="currentSelectedProjectId"
        [nzPlaceHolder]="'Select a project'"
        class="w-full"
      >
        <nz-option
          *ngFor="let p of projectOptions$ | async"
          [nzValue]="p.id"
          [nzLabel]="p.name"
        ></nz-option>
      </nz-select>

      <button nz-button nzType="primary" type="button" (click)="addProject()">
        Add project
      </button>
    </div>
  </div>

  <div formArrayName="projects" class="w-full">
    <nz-collapse>
      <ng-container
        *ngFor="let project of projects.controls; let i = index"
        class="mb-4"
      >
        <ng-container
          *ngIf="getProjectById(project.value) | async as projectInfo"
        >
          <nz-collapse-panel [nzHeader]="projectInfo.name" [nzExtra]="extra">
            <app-update-project-form
              [project]="projectInfo"
            ></app-update-project-form>
          </nz-collapse-panel>
          <ng-template #extra>
            <button
              nz-button
              nzType="primary"
              type="button"
              nzDanger
              (click)="removeProject(i, $event)"
            >
              Remove
            </button>
          </ng-template>
        </ng-container>
      </ng-container>
    </nz-collapse>
  </div>
</form>
<div class="space-x-4 mb-2">
  <button nz-button nzType="primary" (click)="onSubmit()">Submit</button>
  <button nz-button nzType="default" (click)="onPreview()">Preview</button>
</div>
